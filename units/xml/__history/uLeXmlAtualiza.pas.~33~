unit uLeXmlAtualiza;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Samples.Gauges,
  Xml.xmldom, Xml.XMLIntf, Xml.XMLDoc, Data.DB, ZAbstractRODataset,
  ZAbstractDataset, ZDataset;

type
  TfrmLeXmlAtualiza = class(TForm)
    lblLendoXml: TLabel;
    gLendoXml: TGauge;
    xmlAtualiza: TXMLDocument;
    function  GetAlteracaoAnterior(pIDScript:String):Boolean;
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmLeXmlAtualiza: TfrmLeXmlAtualiza;
  zqXml:TZQuery;

implementation

uses
  uDadosFuncoes, uFormularios, uDados;

{$R *.dfm}

function TfrmLeXmlAtualiza.GetAlteracaoAnterior(pIDScript: String): Boolean;
begin
  zqXml :=  TZQuery.Create(nil);
  try
    with zqXml do
    begin
      Connection  :=  DM.conDados;
      if Active then
        Close;
      SQL.Clear;
      SQL.Add('SELECT * FROM TB_ATUALIZACOES WHERE ID = :ID');
      ParamByName('ID').AsString  :=  pIDScript;
      Open; First; FetchAll;
      Result  :=  (RecordCount >= 1);
    end;
  except
    FreeAndNil(zqXml);
  end;
  FreeAndNil(zqXml);
end;

end.
